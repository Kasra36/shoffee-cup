{% extends 'base.html' %} {% block content %}
<body class="search-bg">
  <header class="search-header">
    <div class="search-nav">
      <a href="{{ url_for('home') }}" role="button">HOME</a>
      <a href="{{ url_for('search') }}" role="button">SEARCH</a>
      <a href="{{ url_for('about') }}" role="button">ABOUT</a>
    </div>
  </header>
  <div class="search-forms">
    <div class="left-form">
      <form method="post" action="{{ url_for('search_name') }}">
        <label for="cafe-name"> Search Cafe by Name </label>
        <br /><br />
        <input
          type="search"
          name="cafe-name"
          required
        />
        <br /><br />
        <input type="submit" value="Search" class="search-button-left" />
      </form>
    </div>
    <div class="right-form">
      <form method="post" action="{{ url_for('search_loc') }}">
        <label> Search Cafe by Location</label>
        <table>
          <tr>
            <td>
              <label>Country:</label>
            </td>
            <td>
              <select name="country" id="country" required>
                <option value="">Select</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>
              <label>City:</label>
            </td>

            <td>
              <select name="city" id="city" required>
                <option value="">Select</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>
              <label>Street:</label>
            </td>

            <td>
              <input
                class="solo-input"
                type="search"
                name="street"
                required
              />
            </td>
          </tr>
        </table>
        <input type="submit" value="Search" class="search-button-right" />
      </form>
    </div>
    <div class="search-map">
      <div>Search on Map</div>
      <div>
        <a href="https://www.google.com/maps/" target="_blank"
          ><img
            src="{{ url_for('static', filename='/assets/search-map.svg') }}"
            alt="the earth"
        /></a>
      </div>
    </div>

    <script>
  const countrySelect = document.getElementById("country");
  const citySelect = document.getElementById("city");

  fetch("/static/cities.json")
    .then((res) => res.json())
    .then((data) => {
      Object.keys(data).forEach((country) => {
        const option = document.createElement("option");
        option.value = country;
        option.textContent = country;
        countrySelect.appendChild(option);
      });

      countrySelect.addEventListener("change", () => {
        const cities = data[countrySelect.value] || [];
        citySelect.innerHTML = '<option value="">Select a city</option>';

        if (Array.isArray(cities)) {
          cities.forEach((city) => {
            const option = document.createElement("option");
            option.value = city;
            option.textContent = city;
            citySelect.appendChild(option);
          });
        } else {
          Object.keys(cities).forEach((city) => {
            const option = document.createElement("option");
            option.value = city;
            option.textContent = city;
            citySelect.appendChild(option);
          });
        }
      });
    })
    .catch((err) => console.error("Error loading cities.json:", err));
</script>
  </div>
</body>

{% endblock %}
